//index.js页面
import React from 'react';
import ReactDOM from 'react-dom';
import 'antd/dist/antd.less'
import { Provider } from 'react-redux'
import { persistStore } from 'redux-persist'
import { PersistGate } from 'redux-persist/lib/integration/react'
import './index.less';
import App from './router';
import { store } from './store'
ReactDOM.render(
    <Provider store={store}>
        <PersistGate persistor={persistStore(store)}>
            <App />
        </PersistGate>
    </Provider >
    , document.getElementById('root')
);
import { createStore, compose, applyMiddleware } from 'redux'
import thunk from 'redux-thunk'
import { persistReducer } from 'redux-persist'
import storage from 'redux-persist/lib/storage'
import promise from 'redux-promise'
import autoMergeLevel2 from 'redux-persist/lib/stateReconciler/autoMergeLevel2'
import * as rdc from './reduce/index'//引入reduce/index文件，起别名
const persistConfig = {
    key: 'root',
    storage,
    stateReconciler: autoMergeLevel2,
  }
//数据持久化
const persistedReducer = persistReducer(persistConfig, rdc.login)


const composeEnhancers = (typeof window !== 'undefined' && window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__) || compose;
const store = createStore(
    persistedReducer,
    composeEnhancers(applyMiddleware(promise,thunk))
)
export { store }

//reduce

const initlogin = {
    username:'',
    password:'',
    remember:false,
    dataTable:[
    ],
}


export default function login (state = initlogin,action){
    // console.log(action)
    switch (action.type) {
        case 'LOGIN':
            return { ...state,}
        case 'SAVE':
            return { ...state, ...action.payload}
        case 'TABLE_DATA':
            return { ...state, dataTable: action.payload }
        default:
            return state
    }
}


//reduce抛出页面

import login from'./login'
import home from'./home'
export {
    login,
    home
}


//调用方法action


import request from '../utils/request'
import {get} from '../utils/request'

//login
export function fetchLogin (options) {
    return {
      type: 'LOGIN',
      payload: request('/api/user/login', options),
      
    }
  }
export function remeber (options) {
  // console.log(options)
    return {
      type: 'SAVE',
      payload:options
    }
  }
export function getData () {
    return {
      type: 'TABLE_DATA',
      payload: get('/api/banner/list')
    }
  }
